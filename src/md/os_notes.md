---
title: "Notes on A x64 OS"
date: "2019-12-03"
---

一个64位操作系统的设计与实现（田宇著）。一年前，读过一本32位操作系统实现的书，好像叫 Orange’s ，大概看到保护模式那里就没法再看下去了（读不懂），现在出了新书，讲64位OS的实现，不管怎么样先读起来，然后慢慢记录叭~

**notes** chapter3的第一个boot.asm里面有个清屏的操作，按照书上的代码：
```nohighlight
mov ax, 0600h
mov bx, 0700h
mov cx, 0
mov dx, 0184h
int 10h
```
实现不了鸭（指如果运行在bochs里的话）。```int 10h``` 主要是实现屏幕指定矩形区域的文字向上滚动的功能。若 ```al``` 设置成 ```00h``` 的话，是整个矩形区域的全体文字全部上移，所以书上说的若 ```al``` 设置成 ```00h``` 后面的几个参数都不需要管应该是不对的？（我的理解是至少要设置矩形区域的大小能够超过bochs显示的大小，然后把文字都向上移走，这样就实现了清屏的效果），我的代码如下所示：
```nohighlight
mov ax, 0600h
mov bx, 0700h
mov cx, 0000h
mov dx, 0ffffh
int 10h
```
这里 ```bx``` 设置区域属性的背景都是黑色的，```cx``` 设置矩形左上角坐标，```dx``` 设置矩形右下角坐标，我给设置成了最大的 ```0ffffh``` ，因为我也不知道这个bochs的窗口到底是多大，先放最大的可以偷懒。 T^T

**mistake?** p45求根目录占用的扇区数，根据书中所给数据所列出来的式子是算不到14个扇区这个结果的，但是按照 根目录扇区数 = （根目录中的表项数 * 表项所占字节数） / 512 这个公式算出来确实是14,（怀疑是公式列错了）。